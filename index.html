<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“Š SavdoBot MiniApp</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f4f6f9; }
    h1 { color: #2c3e50; }
    .card { background: #fff; padding: 15px; margin: 10px 0; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .title { font-weight: bold; color: #2980b9; }
  </style>
</head>
<body>
  <h1>ğŸ“¦ Mahsulotlar</h1>
  <div id="products">â³ Yuklanmoqda...</div>

  <h1>ğŸ’¸ Xarajatlar</h1>
  <div id="expenses">â³ Yuklanmoqda...</div>

  <h1>ğŸ“Š Savdolar</h1>
  <div id="sales">â³ Yuklanmoqda...</div>

  <script>
    const BIN_ID = "68c806ded0ea881f407e8f1d";
    const API_KEY = "$2a$10$KJgIisXYAe76dAUceAx/q.ClLQzoPPJgMO9LGklLjlu721WIl2qku";

    async function loadData() {
      const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
        headers: { "X-Master-Key": API_KEY }
      });
      const data = await res.json();
      const record = data.record;

      // Mahsulotlar
      let pHtml = "";
      record.products.forEach(p => {
        pHtml += `<div class="card"><span class="title">${p.name}</span> â€“ ${p.weight} kg</div>`;
      });
      document.getElementById("products").innerHTML = pHtml || "âŒ Mahsulot yoâ€˜q";

      // Xarajatlar
      let eHtml = "";
      record.expenses.forEach(e => {
        eHtml += `<div class="card">${e.amount} soâ€˜m â€“ ${e.date}</div>`;
      });
      document.getElementById("expenses").innerHTML = eHtml || "âŒ Xarajat yoâ€˜q";

      // Savdolar
      let sHtml = "";
      record.sales.forEach(s => {
        sHtml += `<div class="card">${s.product} â€“ ${s.amount} kg â€“ ${s.price} soâ€˜m</div>`;
      });
      document.getElementById("sales").innerHTML = sHtml || "âŒ Savdo yoâ€˜q";
    }

    loadData();
  </script>
</body>
</html>
